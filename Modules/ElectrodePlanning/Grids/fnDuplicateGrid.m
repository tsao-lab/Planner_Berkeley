
function fnDuplicateGrid()
global g_strctModule
iSelectedGrid = get(g_strctModule.m_strctPanel.m_hGridList,'value');
if isempty(iSelectedGrid) || iSelectedGrid == 0 || isempty(g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_astrctGrids)
    return;
end

strctGrid = g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_astrctGrids(iSelectedGrid);

iNewIndex = length(g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_astrctGrids)+1;
g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_astrctGrids(iNewIndex) = strctGrid;

g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_iGridSelected = ...
    length( g_strctModule.m_astrctChambers(g_strctModule.m_iCurrChamber).m_astrctGrids);
fnUpdateGridList();
fnUpdateGridAxes(false);

return;